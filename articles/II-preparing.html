<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>2 Preparing inputs â€¢ timaR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2 Preparing inputs">
<meta property="og:image" content="https://github.com/taxonomicallyinformedannotation/tima-r/blob/main/man/figures/logo.svg">
<meta property="og:image:alt" content="Taxonomically Informed Metabolite Annotation">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@adafede">
<meta name="twitter:site" content="@adafede">
<meta name="google-site-verification" content="Bt77rpBuC_R-0p62TWtA_ba5rvx-PuSEMv4LHg1UsOo">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">timaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/timaR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/I-gathering.html">1 Gathering everything you need</a></li>
    <li><a class="dropdown-item" href="../articles/II-preparing.html">2 Preparing inputs</a></li>
    <li><a class="dropdown-item" href="../articles/III-processing.html">3 Performing Taxonomically Informed Metabolite Annotation</a></li>
    <li><a class="dropdown-item" href="../articles/IV-benchmarking.html">4 Benchmarking Performance</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/taxonomicallyinformedannotation/tima-r/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="II-preparing_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="II-preparing_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="II-preparing_files/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="II-preparing_files/vis-9.1.0/vis-network.min.js"></script><script src="II-preparing_files/visNetwork-binding-2.1.2/visNetwork.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>2 Preparing inputs</h1>
                        <h4 data-toc-skip class="author">Adriano
Rutz</h4>
            
            <h4 data-toc-skip class="date">2024-07-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/taxonomicallyinformedannotation/tima-r/blob/main/vignettes/II-preparing.Rmd" class="external-link"><code>vignettes/II-preparing.Rmd</code></a></small>
      <div class="d-none name"><code>II-preparing.Rmd</code></div>
    </div>

    
    
<p>This vignette describes the main steps of the annotation process.</p>
<div class="section level2">
<h2 id="structural-annotations-of-your-features">Structural annotations of your features<a class="anchor" aria-label="anchor" href="#structural-annotations-of-your-features"></a>
</h2>
<p>For the moment, we support 3 different types of annotations:</p>
<!-- * [GNPS](https://gnps.ucsd.edu) -->
<ul>
<li>Internal MS<sup>1</sup> exact mass-based library search</li>
<li>Internal MS<sup>2</sup> library search (experimental and in
silico)</li>
<li><a href="https://bio.informatik.uni-jena.de/software/sirius" class="external-link">SIRIUS</a></li>
</ul>
<div class="section level3">
<h3 id="ms1-based">MS<sup>1</sup>-based<a class="anchor" aria-label="anchor" href="#ms1-based"></a>
</h3>
<p>These annotations are of the lowest possible quality. However, they
allow to annotate unusual adducts, in-source fragments thanks to
different small tricks implemented. Try to really restrict the adduct
list and structure-organism pairs you want to consider as possibilities
explode rapidly.</p>
</div>
<div class="section level3">
<h3 id="spectral">Spectral<a class="anchor" aria-label="anchor" href="#spectral"></a>
</h3>
<p>We use the <code>spectral entropy</code> from <a href="https://doi.org/10.1038/s41592-021-01331-z" class="external-link uri">https://doi.org/10.1038/s41592-021-01331-z</a> for
matching.</p>
<p>In case, a python implementation of the spectral matching steps is
also available at: <a href="https://github.com/mandelbrot-project/spectral_lib_matcher" class="external-link uri">https://github.com/mandelbrot-project/spectral_lib_matcher</a>.
The python version also includes other similarity measures.</p>
<!-- #### GNPS -->
<!-- We also provide an example GNPS job id, which is: `41c6068e905d482db5698ad81d145d7c` -->
<!-- Before running the corresponding code, do not forget to modify `inst/params/user/prepare_*yourAnnotationTool*.yaml`. -->
<!-- Depending on the annotation tool you used, you can format its results using: -->
</div>
<div class="section level3">
<h3 id="fingerprint-based">Fingerprint-based<a class="anchor" aria-label="anchor" href="#fingerprint-based"></a>
</h3>
<div class="section level4">
<h4 id="sirius">Sirius<a class="anchor" aria-label="anchor" href="#sirius"></a>
</h4>
<p>As SIRIUS jobs are long to perform, we provide example SIRIUS
workspaces (both SIRIUS 5 and 6). Note that spectral matches from SIRIUS
are not supported for now. They have been generated on the 20 first
lines of the example MGF with the following command:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># this is run on SIRIUS 6</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">sirius</span> <span class="dt">\</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>--noCite <span class="dt">\</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>--input=data/source/example_spectra_mini.mgf <span class="dt">\</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>--output=data/interim/annotations/example_sirius.sirius/ <span class="dt">\</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>--maxmz=800 <span class="dt">\</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>config <span class="dt">\</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>--AlgorithmProfile=orbitrap <span class="dt">\</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>--StructureSearchDB=BIO <span class="dt">\</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>--Timeout.secondsPerTree=10 <span class="dt">\</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>--Timeout.secondsPerInstance=10 <span class="dt">\</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>formulas <span class="dt">\</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>zodiac <span class="dt">\</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>fingerprints <span class="dt">\</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>classes <span class="dt">\</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>structures <span class="dt">\</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>denovo-structures <span class="dt">\</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>summaries <span class="dt">\</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>--full-summary</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="co"># this is run on SIRIUS 5</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="ex">sirius</span> <span class="dt">\</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>--noCite <span class="dt">\</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>--input data/source/example_spectra_mini.mgf <span class="dt">\</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>--output data/interim/annotations/example_sirius/ <span class="dt">\</span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>--maxmz 800 <span class="dt">\</span></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>config <span class="dt">\</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>--AlgorithmProfile orbitrap <span class="dt">\</span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>--StructureSearchDB BIO <span class="dt">\</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>--Timeout.secondsPerTree 10 <span class="dt">\</span></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a>--Timeout.secondsPerInstance 10 <span class="dt">\</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a>formula <span class="dt">\</span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a>zodiac <span class="dt">\</span></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a>fingerprint <span class="dt">\</span></span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a>structure <span class="dt">\</span></span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a>compound-classes <span class="dt">\</span></span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a>write-summaries <span class="dt">\</span></span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a>--full-summary</span></code></pre></div>
<p>These parameters were not optimized and were only used to give an
example output. If you are using the cli, do not forget to generate the
summaries with the <code>--full-summary</code> option, or if you use the
gui, generate them by clicking the corresponding icon. You can get an
example running:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"inst/scripts/get_example_sirius.R"</span><span class="op">)</span></span></code></pre></div>
<p>The sirius workspace should have <code>yourPattern_sirius</code> as
name and be placed in <code>data/interim/annotations</code> (else it
will not be found).</p>
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"nodes":{"name":["ann_sir_pre","ann_sir_pre_can","ann_sir_pre_for","ann_sir_pre_str","ann_spe_neg","ann_spe_pos","ann_spe_pre","input_spectra","lib_mer_str_met","lib_mer_str_nam","lib_mer_str_stereo","lib_mer_str_tax_cla","lib_mer_str_tax_npc","lib_rt","lib_rt_sop","lib_sop_clo_pre","lib_sop_ecm","lib_sop_ecm_pre","lib_sop_hmd","lib_sop_hmd_pre","lib_sop_lot","lib_sop_lot_pre","lib_sop_mer","lib_spe_exp_int_pre","lib_spe_exp_int_pre_neg","lib_spe_exp_int_pre_pos","lib_spe_exp_int_pre_sop","lib_spe_exp_mb_pre","lib_spe_exp_mb_pre_neg","lib_spe_exp_mb_pre_pos","lib_spe_exp_mb_pre_sop","lib_spe_exp_mb_raw","lib_spe_is_lot_neg","lib_spe_is_lot_pos","lib_spe_is_lot_pre_neg","lib_spe_is_lot_pre_pos","ann_spe_exp_gnp_pre"],"type":["stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem"],"description":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"status":["outdated","outdated","outdated","outdated","outdated","outdated","outdated","uptodate","outdated","outdated","outdated","outdated","outdated","outdated","outdated","uptodate","uptodate","uptodate","uptodate","uptodate","outdated","outdated","outdated","uptodate","uptodate","uptodate","uptodate","uptodate","uptodate","uptodate","uptodate","uptodate","outdated","outdated","outdated","outdated","outdated"],"seconds":[6.984,0,0,0,0.259,68.535,6.184,0.001,0,0,0,0,0,86.727,0,1.162,0.429,1.976,2.259,41.67,1.585,15.553,40.041,3.71,0,0,0.001,155.859,0,0,0,8.026999999999999,0.005,0,0,0,null],"bytes":[51834,941,571,50322,182,48586,74325,16465,9180250,16588509,8707163,2492003,2389496,7053,3113,268,1334921,177489,96479839,6989505,92979778,46526322,60306265,180721,49019,130197,1505,26771126,6042896,20118984,609246,118649350,168722018,221809332,168722018,221809332,null],"branches":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"label":["ann_sir_pre","ann_sir_pre_can","ann_sir_pre_for","ann_sir_pre_str","ann_spe_neg","ann_spe_pos","ann_spe_pre","input_spectra","lib_mer_str_met","lib_mer_str_nam","lib_mer_str_stereo","lib_mer_str_tax_cla","lib_mer_str_tax_npc","lib_rt","lib_rt_sop","lib_sop_clo_pre","lib_sop_ecm","lib_sop_ecm_pre","lib_sop_hmd","lib_sop_hmd_pre","lib_sop_lot","lib_sop_lot_pre","lib_sop_mer","lib_spe_exp_int_pre","lib_spe_exp_int_pre_neg","lib_spe_exp_int_pre_pos","lib_spe_exp_int_pre_sop","lib_spe_exp_mb_pre","lib_spe_exp_mb_pre_neg","lib_spe_exp_mb_pre_pos","lib_spe_exp_mb_pre_sop","lib_spe_exp_mb_raw","lib_spe_is_lot_neg","lib_spe_is_lot_pos","lib_spe_is_lot_pre_neg","lib_spe_is_lot_pre_pos","ann_spe_exp_gnp_pre"],"color":["#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#354823","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#354823","#354823","#354823","#354823","#354823","#78B7C5","#78B7C5","#78B7C5","#354823","#354823","#354823","#354823","#354823","#354823","#354823","#354823","#354823","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5"],"id":["ann_sir_pre","ann_sir_pre_can","ann_sir_pre_for","ann_sir_pre_str","ann_spe_neg","ann_spe_pos","ann_spe_pre","input_spectra","lib_mer_str_met","lib_mer_str_nam","lib_mer_str_stereo","lib_mer_str_tax_cla","lib_mer_str_tax_npc","lib_rt","lib_rt_sop","lib_sop_clo_pre","lib_sop_ecm","lib_sop_ecm_pre","lib_sop_hmd","lib_sop_hmd_pre","lib_sop_lot","lib_sop_lot_pre","lib_sop_mer","lib_spe_exp_int_pre","lib_spe_exp_int_pre_neg","lib_spe_exp_int_pre_pos","lib_spe_exp_int_pre_sop","lib_spe_exp_mb_pre","lib_spe_exp_mb_pre_neg","lib_spe_exp_mb_pre_pos","lib_spe_exp_mb_pre_sop","lib_spe_exp_mb_raw","lib_spe_is_lot_neg","lib_spe_is_lot_pos","lib_spe_is_lot_pre_neg","lib_spe_is_lot_pre_pos","ann_spe_exp_gnp_pre"],"level":[7,8,8,8,4,4,7,1,6,6,6,6,6,3,4,1,1,2,1,2,1,2,5,1,2,2,2,2,3,3,3,1,1,1,2,2,7],"shape":["dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot"]},"edges":{"from":["lib_sop_ecm","ann_sir_pre","lib_spe_exp_int_pre","lib_spe_exp_mb_pre","lib_spe_exp_int_pre","lib_spe_exp_mb_pre","lib_mer_str_met","lib_mer_str_nam","lib_mer_str_stereo","lib_mer_str_tax_cla","lib_mer_str_tax_npc","lib_spe_is_lot_neg","lib_spe_exp_int_pre_neg","lib_spe_exp_int_pre_pos","lib_spe_is_lot_pre_neg","lib_spe_is_lot_pre_pos","lib_spe_exp_mb_pre","lib_rt_sop","lib_sop_clo_pre","lib_sop_ecm_pre","lib_sop_hmd_pre","lib_sop_lot_pre","lib_spe_exp_int_pre_sop","lib_spe_exp_mb_pre_sop","lib_sop_mer","lib_rt","lib_spe_is_lot_pos","lib_sop_mer","lib_mer_str_met","lib_mer_str_nam","lib_mer_str_stereo","lib_mer_str_tax_cla","lib_mer_str_tax_npc","ann_sir_pre","lib_sop_mer","input_spectra","lib_spe_exp_int_pre_neg","lib_spe_exp_mb_pre_neg","lib_spe_is_lot_pre_neg","ann_spe_neg","ann_spe_pos","lib_mer_str_met","lib_mer_str_nam","lib_mer_str_stereo","lib_mer_str_tax_cla","lib_mer_str_tax_npc","lib_sop_lot","lib_sop_mer","input_spectra","lib_spe_exp_int_pre_pos","lib_spe_exp_mb_pre_pos","lib_spe_is_lot_pre_pos","ann_sir_pre","lib_spe_exp_int_pre","lib_sop_hmd","lib_sop_mer","lib_spe_exp_mb_raw"],"to":["lib_sop_ecm_pre","ann_sir_pre_for","lib_spe_exp_int_pre_sop","lib_spe_exp_mb_pre_sop","lib_spe_exp_int_pre_pos","lib_spe_exp_mb_pre_pos","ann_sir_pre","ann_sir_pre","ann_sir_pre","ann_sir_pre","ann_sir_pre","lib_spe_is_lot_pre_neg","lib_rt","lib_rt","lib_rt","lib_rt","lib_spe_exp_mb_pre_neg","lib_sop_mer","lib_sop_mer","lib_sop_mer","lib_sop_mer","lib_sop_mer","lib_sop_mer","lib_sop_mer","lib_mer_str_nam","lib_rt_sop","lib_spe_is_lot_pre_pos","lib_mer_str_tax_npc","ann_spe_exp_gnp_pre","ann_spe_exp_gnp_pre","ann_spe_exp_gnp_pre","ann_spe_exp_gnp_pre","ann_spe_exp_gnp_pre","ann_sir_pre_str","lib_mer_str_stereo","ann_spe_neg","ann_spe_neg","ann_spe_neg","ann_spe_neg","ann_spe_pre","ann_spe_pre","ann_spe_pre","ann_spe_pre","ann_spe_pre","ann_spe_pre","ann_spe_pre","lib_sop_lot_pre","lib_mer_str_tax_cla","ann_spe_pos","ann_spe_pos","ann_spe_pos","ann_spe_pos","ann_sir_pre_can","lib_spe_exp_int_pre_neg","lib_sop_hmd_pre","lib_mer_str_met","lib_spe_exp_mb_pre"],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":{"type":"cubicBezier","forceDirection":"horizontal"}},"physics":{"stabilization":false},"interaction":{"zoomSpeed":1},"layout":{"hierarchical":{"enabled":true,"direction":"LR"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":{"from":8,"to":1},"algorithm":"hierarchical","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":false,"position":"right","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Outdated","Up to date","Stem"],"color":["#78B7C5","#354823","#899DA4"],"shape":["dot","dot","dot"]},"nodesToDataframe":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script><p>Annotations are now prepared and can be used for further processing.
Your features are not only informed with structural information but
also, chemical class information. The latter might be corresponding
<strong>or not</strong> to the chemical class of your annotated
structure, depending on the consistency of your annotations.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="chemical-class-annotation-of-your-features">Chemical class annotation of your features<a class="anchor" aria-label="anchor" href="#chemical-class-annotation-of-your-features"></a>
</h2>
<p>Within our workflow, we offer a new way to attribute chemical classes
to your features. It is analog to <a href="https://ccms-ucsd.github.io/GNPSDocumentation/nap/" class="external-link">Network
Annotation Propagation</a>, but uses the edges of your network instead
of the clusters. This makes more sense in our view, as also recently
illustrated by <a href="https://doi.org/10.1038/s41587-020-0740-8" class="external-link">CANOPUS</a>.</p>
<!-- All steps can take both manual inputs or GNPS metadata directly from your GNPS job ID. -->
<p>We are currently also working on CANOPUS integration for chemical
class annotation but this implies way heavier computations and we want
to offer our users a <strong>fast</strong> solution.</p>
<div class="section level3">
<h3 id="generating-a-network">Generating a network<a class="anchor" aria-label="anchor" href="#generating-a-network"></a>
</h3>
<p>A network is generated during the process. The edges are created
based on the <code>spectral entropy similarity</code> calculated between
your spectra (see <a href="https://doi.org/10.1038/s41592-021-01331-z" class="external-link uri">https://doi.org/10.1038/s41592-021-01331-z</a>).</p>
<p>If needed, you can get an example of what your minimal feature table
should look like by running (no parameters needed):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"inst/scripts/get_example_features.R"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="biological-source-annotation">Biological source annotation<a class="anchor" aria-label="anchor" href="#biological-source-annotation"></a>
</h2>
<p>This step allows you to attribute biological source information to
your features. If all your features come from a single extract, it will
attribute the biological source of your extract to all your features. If
you have multiple extracts aligned, it will take the <em>n</em>
(according to your parameters) highest intensities of your aligned
feature table and attribute the biological source of corresponding
extracts.
<!-- It can take both manual inputs or GNPS metadata directly from your GNPS job ID. --></p>
</div>
<div class="section level2">
<h2 id="filter-annotations-based-on-retention-time">Filter annotations (based on retention time)<a class="anchor" aria-label="anchor" href="#filter-annotations-based-on-retention-time"></a>
</h2>
<p>This step allows you to filter out the annotation of all the tools
used, based on your own internal (experimental or predicted) retention
times library. It is optional. If you do not have one, it will simply
group the annotations of all tools.</p>
<p>You are almost there! See already all the steps accomplished!</p>
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"nodes":{"name":["ann_fil","ann_ms1_pre","ann_ms1_pre_ann","ann_ms1_pre_edg","ann_sir_pre","ann_sir_pre_can","ann_sir_pre_for","ann_sir_pre_str","ann_spe_exp_gnp_pre","ann_spe_neg","ann_spe_pos","ann_spe_pre","edg_spe","fea_com","fea_com_pre","fea_edg_pre","fea_edg_spe","fea_pre","input_features","input_metadata","input_spectra","int_com","lib_mer_key","lib_mer_org_tax_ott","lib_mer_str_met","lib_mer_str_nam","lib_mer_str_stereo","lib_mer_str_tax_cla","lib_mer_str_tax_npc","lib_rt","lib_rt_rts","lib_rt_sop","lib_sop_clo_pre","lib_sop_ecm","lib_sop_ecm_pre","lib_sop_hmd","lib_sop_hmd_pre","lib_sop_lot","lib_sop_lot_pre","lib_sop_mer","lib_spe_exp_int_pre","lib_spe_exp_int_pre_neg","lib_spe_exp_int_pre_pos","lib_spe_exp_int_pre_sop","lib_spe_exp_mb_pre","lib_spe_exp_mb_pre_neg","lib_spe_exp_mb_pre_pos","lib_spe_exp_mb_pre_sop","lib_spe_exp_mb_raw","lib_spe_is_lot_neg","lib_spe_is_lot_pos","lib_spe_is_lot_pre_neg","lib_spe_is_lot_pre_pos","tax_pre","ann_pre"],"type":["stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem","stem"],"description":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"status":["outdated","outdated","outdated","outdated","outdated","outdated","outdated","outdated","outdated","outdated","outdated","outdated","uptodate","outdated","outdated","outdated","uptodate","uptodate","uptodate","uptodate","uptodate","outdated","outdated","outdated","outdated","outdated","outdated","outdated","outdated","outdated","outdated","outdated","uptodate","uptodate","uptodate","uptodate","uptodate","outdated","outdated","outdated","uptodate","uptodate","uptodate","uptodate","uptodate","uptodate","uptodate","uptodate","uptodate","outdated","outdated","outdated","outdated","outdated","outdated"],"seconds":[6.006,36.155,0,0.001,6.984,0,0,0,0.797,0.259,68.535,6.184,0,0.908,0.138,0.8149999999999999,2.586,0.83,0,0,0.001,0,0,0,0,0,0,0,0,86.727,0,0,1.162,0.429,1.976,2.259,41.67,1.134,15.553,40.041,3.71,0,0,0.001,155.859,0,0,0,8.026999999999999,0.005,0,0,0,3.08,null],"bytes":[26142972,25520044,25277275,242769,51834,941,571,50322,232,182,48586,74325,725,44643,44638,268381,725,127961,787114,261,16465,44643,20009680,939164,9180250,16588509,8707163,2492003,2389496,7053,3940,3113,268,1334921,177489,96479839,6989505,92979778,46526322,60306265,180721,49019,130197,1505,26771126,6042896,20118984,609246,118649350,168722018,221809332,168722018,221809332,27296,null],"branches":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"label":["ann_fil","ann_ms1_pre","ann_ms1_pre_ann","ann_ms1_pre_edg","ann_sir_pre","ann_sir_pre_can","ann_sir_pre_for","ann_sir_pre_str","ann_spe_exp_gnp_pre","ann_spe_neg","ann_spe_pos","ann_spe_pre","edg_spe","fea_com","fea_com_pre","fea_edg_pre","fea_edg_spe","fea_pre","input_features","input_metadata","input_spectra","int_com","lib_mer_key","lib_mer_org_tax_ott","lib_mer_str_met","lib_mer_str_nam","lib_mer_str_stereo","lib_mer_str_tax_cla","lib_mer_str_tax_npc","lib_rt","lib_rt_rts","lib_rt_sop","lib_sop_clo_pre","lib_sop_ecm","lib_sop_ecm_pre","lib_sop_hmd","lib_sop_hmd_pre","lib_sop_lot","lib_sop_lot_pre","lib_sop_mer","lib_spe_exp_int_pre","lib_spe_exp_int_pre_neg","lib_spe_exp_int_pre_pos","lib_spe_exp_int_pre_sop","lib_spe_exp_mb_pre","lib_spe_exp_mb_pre_neg","lib_spe_exp_mb_pre_pos","lib_spe_exp_mb_pre_sop","lib_spe_exp_mb_raw","lib_spe_is_lot_neg","lib_spe_is_lot_pos","lib_spe_is_lot_pre_neg","lib_spe_is_lot_pre_pos","tax_pre","ann_pre"],"color":["#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#354823","#78B7C5","#78B7C5","#78B7C5","#354823","#354823","#354823","#354823","#354823","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#354823","#354823","#354823","#354823","#354823","#78B7C5","#78B7C5","#78B7C5","#354823","#354823","#354823","#354823","#354823","#354823","#354823","#354823","#354823","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5","#78B7C5"],"id":["ann_fil","ann_ms1_pre","ann_ms1_pre_ann","ann_ms1_pre_edg","ann_sir_pre","ann_sir_pre_can","ann_sir_pre_for","ann_sir_pre_str","ann_spe_exp_gnp_pre","ann_spe_neg","ann_spe_pos","ann_spe_pre","edg_spe","fea_com","fea_com_pre","fea_edg_pre","fea_edg_spe","fea_pre","input_features","input_metadata","input_spectra","int_com","lib_mer_key","lib_mer_org_tax_ott","lib_mer_str_met","lib_mer_str_nam","lib_mer_str_stereo","lib_mer_str_tax_cla","lib_mer_str_tax_npc","lib_rt","lib_rt_rts","lib_rt_sop","lib_sop_clo_pre","lib_sop_ecm","lib_sop_ecm_pre","lib_sop_hmd","lib_sop_hmd_pre","lib_sop_lot","lib_sop_lot_pre","lib_sop_mer","lib_spe_exp_int_pre","lib_spe_exp_int_pre_neg","lib_spe_exp_int_pre_pos","lib_spe_exp_int_pre_sop","lib_spe_exp_mb_pre","lib_spe_exp_mb_pre_neg","lib_spe_exp_mb_pre_pos","lib_spe_exp_mb_pre_sop","lib_spe_exp_mb_raw","lib_spe_is_lot_neg","lib_spe_is_lot_pos","lib_spe_is_lot_pre_neg","lib_spe_is_lot_pre_pos","tax_pre","ann_pre"],"level":[9,7,8,8,7,8,8,8,7,4,4,7,3,10,12,9,2,2,1,1,1,11,6,6,6,6,6,6,6,3,4,4,1,1,2,1,2,1,2,5,1,2,2,2,2,3,3,3,1,1,1,2,2,7,13],"shape":["dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot"]},"edges":{"from":["lib_sop_ecm","ann_sir_pre","int_com","lib_spe_exp_int_pre","lib_spe_exp_mb_pre","ann_ms1_pre","lib_spe_exp_int_pre","lib_spe_exp_mb_pre","lib_mer_str_met","lib_mer_str_nam","lib_mer_str_stereo","lib_mer_str_tax_cla","lib_mer_str_tax_npc","ann_ms1_pre","fea_edg_spe","lib_spe_is_lot_neg","lib_spe_exp_int_pre_neg","lib_spe_exp_int_pre_pos","lib_spe_is_lot_pre_neg","lib_spe_is_lot_pre_pos","lib_sop_mer","fea_edg_pre","lib_spe_exp_mb_pre","input_features","ann_fil","ann_sir_pre_can","ann_sir_pre_for","fea_com_pre","fea_edg_pre","lib_mer_key","lib_mer_org_tax_ott","lib_mer_str_stereo","tax_pre","lib_rt_sop","lib_sop_clo_pre","lib_sop_ecm_pre","lib_sop_hmd_pre","lib_sop_lot_pre","lib_spe_exp_int_pre_sop","lib_spe_exp_mb_pre_sop","fea_com","lib_sop_mer","lib_rt","input_spectra","lib_spe_is_lot_pos","lib_sop_mer","input_features","input_metadata","lib_mer_org_tax_ott","lib_mer_str_met","lib_mer_str_nam","lib_mer_str_stereo","lib_mer_str_tax_cla","lib_mer_str_tax_npc","ann_sir_pre","lib_sop_mer","input_spectra","lib_spe_exp_int_pre_neg","lib_spe_exp_mb_pre_neg","lib_spe_is_lot_pre_neg","ann_spe_neg","ann_spe_pos","lib_mer_str_met","lib_mer_str_nam","lib_mer_str_stereo","lib_mer_str_tax_cla","lib_mer_str_tax_npc","lib_sop_lot","lib_rt","lib_sop_mer","ann_ms1_pre_ann","ann_sir_pre_str","ann_spe_exp_gnp_pre","ann_spe_pre","fea_pre","lib_rt_rts","input_spectra","lib_spe_exp_int_pre_pos","lib_spe_exp_mb_pre_pos","lib_spe_is_lot_pre_pos","fea_pre","lib_mer_key","lib_mer_str_met","lib_mer_str_nam","lib_mer_str_stereo","lib_mer_str_tax_cla","lib_mer_str_tax_npc","lib_sop_mer","ann_ms1_pre_edg","edg_spe","ann_sir_pre","lib_spe_exp_int_pre","lib_sop_hmd","lib_sop_mer","lib_spe_exp_mb_raw"],"to":["lib_sop_ecm_pre","ann_sir_pre_for","fea_com_pre","lib_spe_exp_int_pre_sop","lib_spe_exp_mb_pre_sop","ann_ms1_pre_edg","lib_spe_exp_int_pre_pos","lib_spe_exp_mb_pre_pos","ann_sir_pre","ann_sir_pre","ann_sir_pre","ann_sir_pre","ann_sir_pre","ann_ms1_pre_ann","edg_spe","lib_spe_is_lot_pre_neg","lib_rt","lib_rt","lib_rt","lib_rt","lib_mer_org_tax_ott","fea_com","lib_spe_exp_mb_pre_neg","fea_pre","ann_pre","ann_pre","ann_pre","ann_pre","ann_pre","ann_pre","ann_pre","ann_pre","ann_pre","lib_sop_mer","lib_sop_mer","lib_sop_mer","lib_sop_mer","lib_sop_mer","lib_sop_mer","lib_sop_mer","int_com","lib_mer_str_nam","lib_rt_sop","fea_edg_spe","lib_spe_is_lot_pre_pos","lib_mer_str_tax_npc","tax_pre","tax_pre","tax_pre","ann_spe_exp_gnp_pre","ann_spe_exp_gnp_pre","ann_spe_exp_gnp_pre","ann_spe_exp_gnp_pre","ann_spe_exp_gnp_pre","ann_sir_pre_str","lib_mer_str_stereo","ann_spe_neg","ann_spe_neg","ann_spe_neg","ann_spe_neg","ann_spe_pre","ann_spe_pre","ann_spe_pre","ann_spe_pre","ann_spe_pre","ann_spe_pre","ann_spe_pre","lib_sop_lot_pre","lib_rt_rts","lib_mer_str_tax_cla","ann_fil","ann_fil","ann_fil","ann_fil","ann_fil","ann_fil","ann_spe_pos","ann_spe_pos","ann_spe_pos","ann_spe_pos","ann_ms1_pre","ann_ms1_pre","ann_ms1_pre","ann_ms1_pre","ann_ms1_pre","ann_ms1_pre","ann_ms1_pre","lib_mer_key","fea_edg_pre","fea_edg_pre","ann_sir_pre_can","lib_spe_exp_int_pre_neg","lib_sop_hmd_pre","lib_mer_str_met","lib_spe_exp_mb_pre"],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":{"type":"cubicBezier","forceDirection":"horizontal"}},"physics":{"stabilization":false},"interaction":{"zoomSpeed":1},"layout":{"hierarchical":{"enabled":true,"direction":"LR"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":{"from":8,"to":1},"algorithm":"hierarchical","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":false,"position":"right","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Outdated","Up to date","Stem"],"color":["#78B7C5","#354823","#899DA4"],"shape":["dot","dot","dot"]},"nodesToDataframe":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script><p>We now recommend you to read the <a href="https://taxonomicallyinformedannotation.github.io/tima-r/articles/III-processing.html">next
vignette</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adriano Rutz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
